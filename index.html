<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>åŒ—æµ·é“èœœæœˆæ‰‹å¸³ â„ï¸ 2026 ä¿®æ­£ç‰ˆ</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <style>
        :root { 
            --primary: #3A86FF; --green: #81B29A; --bg: #FDFBF7; --text: #333; 
            --heart-pink: #FFC0CB; --card-shadow: 0 4px 15px rgba(0,0,0,0.05);
        }
        
        body { background: var(--bg); font-family: "PingFang TC", sans-serif; margin: 0; padding-bottom: 120px; color: var(--text); }

        /* é ‚éƒ¨è³‡è¨Š */
        .top-info-bar { background: #fff; padding: 25px 20px; border-bottom: 1px solid #F0F0F0; position: sticky; top: 0; z-index: 100; }
        .main-title { font-size: 24px; font-weight: bold; color: var(--green); margin-bottom: 6px; }
        .countdown-badge { background: #000; color: #fff; padding: 4px 12px; border-radius: 20px; font-size: 12px; float: right; }

        /* æ—¥æœŸé¸æ“‡å™¨ */
        .date-scroller { display: flex; overflow-x: auto; gap: 12px; padding: 15px; background: #fff; scrollbar-width: none; }
        .date-scroller::-webkit-scrollbar { display: none; }
        .date-card {
            flex: 0 0 75px; height: 90px; background: #fff; border-radius: 18px;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            border: 1px solid #EEE; transition: 0.3s;
        }
        .date-card.active { background: var(--primary); border-color: var(--primary); color: #fff; }

        /* è¡Œç¨‹å¡ç‰‡ç´°ç¯€ */
        .card { background: #fff; border-radius: 24px; padding: 20px; margin: 12px 15px; box-shadow: var(--card-shadow); position: relative; }
        .trip-time { color: var(--primary); font-size: 13px; font-weight: bold; margin-bottom: 5px; }
        .trip-title { font-size: 19px; font-weight: bold; margin-bottom: 10px; }
        /* å‚™å¿˜éŒ„é»ƒè‰²å°å¡ */
        .trip-note-box { 
            background: #FFF9C4; 
            padding: 12px; 
            border-radius: 12px; 
            font-size: 14px; 
            border: 1px dashed #E6D978; 
            color: #555; 
            line-height: 1.5;
            margin-top: 5px;
        }

        /* è¼¸å…¥æ§ä»¶ */
        input, textarea, select { width: 100%; padding: 14px; margin-top: 10px; border: 1px solid #F0F0F0; border-radius: 15px; box-sizing: border-box; background: #FAFAFA; font-size: 15px; outline: none; }
        .btn-add { background: #000; color: #fff; border: none; padding: 16px; border-radius: 20px; width: 100%; font-weight: bold; margin-top: 15px; }

        /* å°è¦½åˆ— */
        .nav-bar { position: fixed; bottom: 20px; left: 10px; right: 10px; height: 75px; background: #222; border-radius: 35px; display: flex; justify-content: space-around; align-items: center; z-index: 1000; }
        .nav-item { color: #666; text-align: center; flex: 1; border: none; background: none; }
        .nav-item.active { color: #FFF; }
        .nav-text { font-size: 10px; display: block; margin-top: 4px; }
        
        .delete-btn { color: #DDD; font-size: 18px; position: absolute; top: 20px; right: 20px; }
        .tag { font-size: 10px; padding: 3px 8px; border-radius: 6px; font-weight: bold; margin-right: 8px; }
    </style>
</head>
<body>
    <div id="app">
        <div class="top-info-bar">
            <div class="countdown-badge">D-{{ globalCountdown }}</div>
            <div class="main-title">åŒ—æµ·é“èœœæœˆæ—…è¡Œ</div>
            <div style="font-size: 14px; color: #888;">âœˆï¸ 2026 å‡½é¤¨ã€æœ­å¹Œ 12æ—¥éŠ</div>
        </div>

        <div v-if="activeTab === 'trip'">
            <div class="date-scroller">
                <div v-for="d in 12" :key="d" class="date-card" :class="{active: currentDay === d}" @click="currentDay = d">
                    <span style="font-size:10px;">DAY {{ d }}</span>
                    <span style="font-size:20px; font-weight:bold;">{{ getShortDate(d) }}</span>
                </div>
            </div>

            <div class="card">
                <input v-model="newTrip.desc" placeholder="è¡Œç¨‹åç¨± (ä¾‹å¦‚: å‡½é¤¨æœå¸‚)">
                <div style="display:flex; gap:10px;">
                    <input v-model="newTrip.startTime" type="time">
                    <input v-model="newTrip.endTime" type="time">
                </div>
                <textarea v-model="newTrip.note" placeholder="è¡Œç¨‹å‚™å¿˜éŒ„ (ä¾‹å¦‚: å¿…åƒæµ·è†½ä¸¼ã€é€™å®¶è¦æ’éšŠ...)" rows="2"></textarea>
                <button class="btn-add" @click="addTrip">åŠ å…¥è¡Œç¨‹</button>
            </div>

            <div v-for="item in filteredTrips" :key="item.id" class="card">
                <div class="delete-btn" @click="removeTrip(item.id)">âœ•</div>
                <div class="trip-time">âŒš {{item.startTime}} - {{item.endTime}}</div>
                <div class="trip-title">{{item.desc}}</div>
                <div v-if="item.note" class="trip-note-box">
                    <strong>ğŸ“ å‚™å¿˜ï¼š</strong><br>{{item.note}}
                </div>
            </div>
        </div>

        <div v-if="activeTab === 'booking'">
            <div class="card" style="display:flex; gap:10px;">
                <button @click="bookSub='trans'" :style="bookSub==='trans'?'background:#333;color:#fff':'background:#eee'" style="flex:1;border:none;padding:10px;border-radius:10px;">äº¤é€š</button>
                <button @click="bookSub='stay'" :style="bookSub==='stay'?'background:#333;color:#fff':'background:#eee'" style="flex:1;border:none;padding:10px;border-radius:10px;">ä½å®¿</button>
            </div>
            <div class="card">
                <input v-model="newBook.title" placeholder="åç¨±">
                <input v-model="newBook.info" placeholder="è³‡è¨Š">
                <button class="btn-add" @click="addBook" style="background:var(--green)">å„²å­˜</button>
            </div>
            <div v-for="(b, i) in (bookSub==='trans'?transport:stays)" :key="i" class="card">
                <div class="delete-btn" @click="removeBook(i)">âœ•</div>
                <div style="font-weight:bold;">{{b.title}}</div>
                <div style="color:#666;font-size:14px;">{{b.info}}</div>
            </div>
        </div>

        <div v-if="activeTab === 'list'">
            <div class="card">
                <div style="display:flex; gap:10px;">
                    <input v-model="newItem" placeholder="æ–°å¢æ¸…å–®..." style="margin:0;">
                    <button class="btn-add" @click="addItem" style="width:60px; margin:0;">+</button>
                </div>
            </div>
            <div class="card">
                <div v-for="(item, index) in checklist" :key="index" style="display:flex; align-items:center; padding:10px 0; border-bottom:1px solid #eee;">
                    <input type="checkbox" v-model="item.done" @change="save" style="width:20px;height:20px;margin-right:10px;">
                    <span :style="item.done?'text-decoration:line-through;color:#bbb':''" style="flex:1">{{item.text}}</span>
                    <span @click="removeItem(index)" style="color:#ddd">âœ•</span>
                </div>
            </div>
        </div>

        <div v-if="activeTab === 'money'">
            <div class="card" style="background:#222; color:#fff; text-align:center;">
                <div style="font-size:32px; font-weight:800;">Â¥ {{ totalSpent }}</div>
                <div style="color:var(--heart-pink)">ç´„ NT$ {{ Math.round(totalSpent * 0.21) }}</div>
            </div>
            <div class="card">
                <select v-model="newExp.category">
                    <option v-for="c in categories" :value="c.n">{{c.i}} {{c.n}}</option>
                </select>
                <input v-model.number="newExp.amount" type="number" placeholder="é‡‘é¡ (JPY)">
                <input v-model="newExp.note" placeholder="èŠ±è²»èªªæ˜">
                <button class="btn-add" @click="addExp">æ–°å¢æ”¯å‡º</button>
            </div>
            <div v-for="(exp, index) in expenses" :key="index" class="card" style="display:flex; align-items:center;">
                <span class="tag" :style="{background: getCatColor(exp.category)}">{{exp.category}}</span>
                <span style="flex:1"><b>{{exp.note}}</b></span>
                <span>Â¥ {{exp.amount}}</span>
                <span @click="removeExp(index)" style="margin-left:15px;color:#ddd">âœ•</span>
            </div>
        </div>

        <nav class="nav-bar">
            <button v-for="t in [{k:'trip',i:'ğŸ—“ï¸',t:'è¡Œç¨‹'},{k:'booking',i:'ğŸ”–',t:'é è¨‚'},{k:'list',i:'âœ…',t:'æ¸…å–®'},{k:'money',i:'ğŸª™',t:'è¨˜å¸³'}]" 
                    :key="t.k" class="nav-item" :class="{active: activeTab === t.k}" @click="activeTab = t.k">
                <span style="font-size:22px;">{{ t.i }}</span><span class="nav-text">{{ t.t }}</span>
            </button>
        </nav>
    </div>

    <script>
        const { createApp } = Vue
        createApp({
            data() {
                return {
                    activeTab: 'trip', currentDay: 1, bookSub: 'trans',
                    startDate: '2026-01-12',
                    newTrip: { desc: '', startTime: '09:00', endTime: '10:00', note: '' },
                    newBook: { title: '', info: '' },
                    newExp: { amount: null, note: '', category: 'åƒå–' },
                    newItem: '',
                    categories: [{n:'åƒå–',i:'ğŸ±',c:'#FFADAD'},{n:'äº¤é€š',i:'ğŸš„',c:'#9BF6FF'},{n:'è³¼ç‰©',i:'ğŸ›ï¸',c:'#FFD6A5'},{n:'æ™¯é»',i:'ğŸ¡',c:'#CAFFBF'},{n:'å…¶ä»–',i:'âœ¨',c:'#BDB2FF'}],
                    trips: JSON.parse(localStorage.getItem('h_t_v31') || '[]'),
                    transport: JSON.parse(localStorage.getItem('h_tr_v31') || '[]'),
                    stays: JSON.parse(localStorage.getItem('h_s_v31') || '[]'),
                    expenses: JSON.parse(localStorage.getItem('h_m_v31') || '[]'),
                    checklist: JSON.parse(localStorage.getItem('h_l_v31') || [{text:'è­·ç…§',done:false},{text:'æ—¥å¹£',done:false}])
                }
            },
            computed: {
                globalCountdown() {
                    const diff = new Date(this.startDate) - new Date();
                    return Math.max(0, Math.ceil(diff / (1000 * 60 * 60 * 24)));
                },
                filteredTrips() {
                    return this.trips.filter(t => t.day === this.currentDay).sort((a,b) => a.startTime.localeCompare(b.startTime));
                },
                totalSpent() { return this.expenses.reduce((sum, item) => sum + (item.amount || 0), 0); }
            },
            methods: {
                getShortDate(day) {
                    const d = new Date(this.startDate); d.setDate(d.getDate() + (day - 1));
                    return `${d.getMonth() + 1}/${d.getDate()}`;
                },
                addTrip() {
                    if(!this.newTrip.desc) return;
                    this.trips.push({ id: Date.now(), day: this.currentDay, ...this.newTrip });
                    this.save();
                    this.newTrip = { desc: '', startTime: '09:00', endTime: '10:00', note: '' };
                },
                removeTrip(id) { this.trips = this.trips.filter(t => t.id !== id); this.save(); },
                addBook() {
                    if(this.bookSub==='trans') this.transport.push({...this.newBook});
                    else this.stays.push({...this.newBook});
                    this.save(); this.newBook = { title: '', info: '' };
                },
                removeBook(i) {
                    if(this.bookSub==='trans') this.transport.splice(i, 1);
                    else this.stays.splice(i, 1);
                    this.save();
                },
                addItem() { if(this.newItem){ this.checklist.push({text:this.newItem,done:false}); this.save(); this.newItem=''; } },
                removeItem(i) { this.checklist.splice(i, 1); this.save(); },
                addExp() { if(this.newExp.amount){ this.expenses.unshift({...this.newExp}); this.save(); this.newExp.amount=null; this.newExp.note=''; } },
                removeExp(i) { this.expenses.splice(i, 1); this.save(); },
                getCatColor(n) { return this.categories.find(c=>c.n===n).c; },
                save() {
                    localStorage.setItem('h_t_v31', JSON.stringify(this.trips));
                    localStorage.setItem('h_tr_v31', JSON.stringify(this.transport));
                    localStorage.setItem('h_s_v31', JSON.stringify(this.stays));
                    localStorage.setItem('h_m_v31', JSON.stringify(this.expenses));
                    localStorage.setItem('h_l_v31', JSON.stringify(this.checklist));
                }
            }
        }).mount('#app')
    </script>
</body>
</html>
