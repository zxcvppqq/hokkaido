<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>åŒ—æµ·é“èœœæœˆæ‰‹å¸³ â„ï¸ 1/12-1/23 å°ˆå±¬ç‰ˆ</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <style>
        :root { 
            --primary: #3A86FF; 
            --bg: #FDFBF7; 
            --text: #333; 
            --heart-pink: #FFC0CB;
            --memo-bg: #FFF9C4;
        }
        
        body { background: var(--bg); font-family: "PingFang TC", sans-serif; margin: 0; padding-bottom: 120px; color: var(--text); overflow-x: hidden; }

        /* æ¨™é¡Œæ¬„ä½ */
        .header-bar { background: #fff; padding: 15px; border-bottom: 1px solid #EEE; text-align: center; position: sticky; top: 0; z-index: 1100; }
        .countdown-text { font-size: 13px; font-weight: bold; background: #000; color: #fff; padding: 4px 12px; border-radius: 20px; display: inline-block; }

        /* æ©«å‘æ—¥æœŸé¸æ“‡å™¨ (1/12 - 1/23) */
        .date-scroller { 
            display: flex; overflow-x: auto; gap: 10px; padding: 15px; 
            background: var(--bg);
            scrollbar-width: none; -ms-overflow-style: none;
        }
        .date-scroller::-webkit-scrollbar { display: none; }
        
        .date-card {
            flex: 0 0 70px; height: 90px; background: #fff; border-radius: 15px;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            border: 1px solid #EEE; box-shadow: 0 2px 8px rgba(0,0,0,0.05); transition: 0.3s;
        }
        .date-card.active { background: var(--primary); border-color: var(--primary); color: #fff; }
        .date-card .day-num { font-size: 10px; opacity: 0.8; margin-bottom: 5px; }
        .date-card .date-text { font-size: 18px; font-weight: bold; }
        .date-card .week-text { font-size: 12px; margin-top: 5px; }

        /* å…§å®¹æ¨™é¡Œ */
        .section-header { padding: 0 15px; display: flex; align-items: center; justify-content: space-between; margin-top: 10px; }
        .section-title { font-weight: bold; font-size: 16px; border-left: 4px solid var(--primary); padding-left: 10px; }

        /* å¡ç‰‡è¨­è¨ˆ */
        .card { background: #fff; border-radius: 20px; padding: 15px; margin: 10px 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); position: relative; border: 1px solid #F0F0F0; }
        .item-time { font-size: 12px; color: #999; font-weight: bold; }
        .item-name { font-size: 17px; font-weight: bold; margin: 5px 0; }
        .item-memo { background: var(--memo-bg); padding: 12px; border-radius: 12px; font-size: 13px; color: #444; border: 1px dashed #E6D978; line-height: 1.5; margin-top: 8px; }
        
        /* è¡¨å–®èˆ‡æŒ‰éˆ• */
        input, select, textarea { width: 100%; padding: 12px; margin-top: 10px; border: 1px solid #EEE; border-radius: 12px; box-sizing: border-box; background: #FAFAFA; font-size: 14px; outline: none; }
        input:focus { border-color: var(--primary); }
        .btn-add { background: #000; color: #fff; border: none; padding: 15px; border-radius: 15px; width: 100%; font-weight: bold; margin-top: 10px; active: scale(0.98); }
        
        /* å°è¦½åˆ— */
        .nav-bar { position: fixed; bottom: 20px; left: 20px; right: 20px; height: 65px; background: #222; border-radius: 35px; display: flex; justify-content: space-around; align-items: center; z-index: 1000; box-shadow: 0 10px 30px rgba(0,0,0,0.2); }
        .nav-item { color: #888; text-align: center; flex: 1; border: none; background: none; outline: none; }
        .nav-item.active { color: var(--heart-pink); }
        .nav-text { font-size: 10px; display: block; margin-top: 4px; }

        .weather-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .w-box { background: #F0F7FF; padding: 15px; border-radius: 15px; text-align: center; }
        .delete-btn { position: absolute; top: 15px; right: 15px; color: #DDD; font-size: 18px; padding: 5px; }
    </style>
</head>
<body>
    <div id="app">
        <div class="header-bar">
            <div class="countdown-text">â„ï¸ 1/12 å‡ºç™¼å€’æ•¸ {{ globalCountdown }} å¤©</div>
        </div>

        <div v-if="activeTab === 'trip' || activeTab === 'weather'" class="date-scroller">
            <div v-for="d in 12" :key="d" 
                 class="date-card" 
                 :class="{active: currentDay === d}"
                 @click="currentDay = d">
                <div class="day-num">DAY {{ d }}</div>
                <div class="date-text">{{ getShortDate(d) }}</div>
                <div class="week-text">{{ getWeekDay(d) }}</div>
            </div>
        </div>

        <div v-if="activeTab === 'trip'">
            <div class="section-header">
                <div class="section-title">Day {{currentDay}} è¡Œç¨‹å®‰æ’</div>
            </div>

            <div class="card">
                <div style="display:flex; gap:10px;"><input v-model="newTrip.startTime" type="time"><input v-model="newTrip.endTime" type="time"></div>
                <input v-model="newTrip.desc" placeholder="åœ°é»æˆ–æ´»å‹•åç¨±">
                <textarea v-model="newTrip.note" placeholder="æ¯å€‹åœ°é»çš„å°ˆå±¬å‚™å¿˜éŒ„ (å¦‚ï¼šé ç´„è™Ÿã€å¿…è²·ç‰©å“)" rows="2"></textarea>
                <button class="btn-add" @click="addTrip">åŠ å…¥è¡Œç¨‹</button>
            </div>

            <div v-for="item in filteredTrips" :key="item.id" class="card">
                <div class="delete-btn" @click="removeTrip(item.id)">âœ•</div>
                <div class="item-time">âŒš {{ item.startTime }} - {{ item.endTime }}</div>
                <div class="item-name">{{ item.desc }}</div>
                <div v-if="item.note" class="item-memo">{{ item.note }}</div>
                <a :href="'https://www.google.com/maps/search/?api=1&query=' + encodeURIComponent(item.desc)" target="_blank" style="display:inline-block; margin-top:12px; font-size:12px; color:var(--primary); font-weight:bold; text-decoration:none;">ğŸ“ å°èˆªåˆ°æ­¤</a>
            </div>
        </div>

        <div v-if="activeTab === 'weather'">
            <div class="section-header"><div class="section-title">1/{{ 11+currentDay }} ç’°å¢ƒç›£æ¸¬</div></div>
            <div class="card weather-grid">
                <div class="w-box"><div style="font-size:11px; color:#666;">ğŸŒ… æ—¥å‡º</div><div style="font-weight:bold;">06:51</div></div>
                <div class="w-box"><div style="font-size:11px; color:#666;">ğŸŒ‡ æ—¥è½</div><div style="font-weight:bold;">16:22</div></div>
                <div class="w-box"><div style="font-size:11px; color:#666;">ğŸŒ¡ï¸ é«”æ„Ÿ</div><div style="font-weight:bold;">-6Â°C / -1Â°C</div></div>
                <div class="w-box"><div style="font-size:11px; color:#666;">â„ï¸ é™é›ª</div><div style="font-weight:bold;">40%</div></div>
            </div>
            <div class="card" style="background: linear-gradient(135deg, #3A86FF, #8E44AD); color:#fff; border:none;">
                <div style="font-weight:bold; margin-bottom:10px;">ğŸ§¥ å»ºè­°ç©¿æ­</div>
                <div style="font-size:13px; opacity:0.9;">å…§å±¤ï¼šç™¼ç†±è¡£ / ä¸­å±¤ï¼šæ¯›è¡£æˆ–åšè¡›è¡£ / å¤–å±¤ï¼šé•·ç‰ˆé˜²é¢¨ç¾½çµ¨ã€‚é‹åº•å‹™å¿…è²¼ä¸Šé˜²æ»‘ç‰‡ã€‚</div>
            </div>
        </div>

        <div v-if="activeTab === 'list'">
            <div class="card"><div class="section-title">è¡Œææ¸…å–®</div>
                <div style="display:flex; gap:10px; margin-top:10px;"><input v-model="newItem" placeholder="è¼¸å…¥ç‰©å“..." style="margin:0;"><button class="btn-add" @click="addItem" style="margin:0; width:60px;">+</button></div>
            </div>
            <div v-for="(item, index) in checklist" :key="index" class="card" @click="toggleItem(index)" style="display:flex; align-items:center;">
                <div :style="{width:'20px', height:'20px', borderRadius:'5px', border:'2px solid #000', marginRight:'12px', background: item.done ? '#000' : 'none'}"></div>
                <span :style="{textDecoration: item.done ? 'line-through' : 'none'}">{{ item.text }}</span>
                <span @click.stop="removeItem(index)" style="margin-left:auto; color:#DDD;">âœ•</span>
            </div>
        </div>

        <div v-if="activeTab === 'money'">
            <div class="card" style="background:#000; color:#fff; text-align:center; padding:25px;">
                <div style="font-size:28px; font-weight:bold;">Â¥ {{ totalSpent }}</div>
                <div style="font-size:12px; color:var(--heart-pink);">ç´„ NT$ {{ Math.round(totalSpent * 0.21) }}</div>
            </div>
            <div class="card">
                <input v-model.number="newExp.amount" type="number" placeholder="æ—¥å¹£é‡‘é¡">
                <input v-model="newExp.note" placeholder="é …ç›®å…§å®¹">
                <button class="btn-add" @click="addExp">å„²å­˜æ”¯å‡º</button>
            </div>
            <div v-for="(exp, index) in expenses" :key="index" class="card" style="display:flex; justify-content:space-between;">
                <span>{{ exp.note }}</span><b>Â¥ {{ exp.amount }}</b>
            </div>
        </div>

        <div v-if="activeTab === 'member'">
            <div class="card"><div class="section-title">æ—…ç¨‹è¨­å®š</div>
                <input v-model="startDate" type="date">
            </div>
            <div v-for="role in ['girl', 'boy']" :key="role" class="card">
                <div style="display:flex; align-items:center; gap:15px;">
                    <div style="width:60px; height:60px; border-radius:50%; border:2px solid #000; overflow:hidden;"><img :src="members[role].img" style="width:100%; height:100%; object-fit:cover;"></div>
                    <div style="flex:1;"><input v-model="members[role].name"><input v-model="members[role].note" style="margin-top:5px;"></div>
                </div>
                <input v-model="members[role].img" placeholder="é ­åƒç¶²å€" style="font-size:11px;">
            </div>
            <button class="btn-add" @click="saveMembers">ğŸ’¾ å„²å­˜è¨­å®š</button>
        </div>

        <nav class="nav-bar">
            <button v-for="tab in [{k:'trip',i:'ğŸ—“ï¸',t:'è¡Œç¨‹'},{k:'weather',i:'â„ï¸',t:'ç©¿æ­'},{k:'list',i:'âœ…',t:'æ¸…å–®'},{k:'money',i:'ğŸª™',t:'è¨˜å¸³'},{k:'member',i:'ğŸ‘¥',t:'æˆ‘å€‘'}]" 
                    :key="tab.k" class="nav-item" :class="{active: activeTab === tab.k}" @click="activeTab = tab.k">
                <span style="font-size:22px;">{{ tab.i }}</span><span class="nav-text">{{ tab.t }}</span>
            </button>
        </nav>
    </div>

    <script>
        const { createApp } = Vue
        createApp({
            data() {
                return {
                    activeTab: 'trip', currentDay: 1,
                    newTrip: { startTime: '', endTime: '', desc: '', note: '' },
                    newExp: { amount: null, note: '' }, newItem: '',
                    startDate: localStorage.getItem('h_start_v19') || '2025-01-12',
                    weatherMemos: JSON.parse(localStorage.getItem('h_weather_memo_v19') || '{}'),
                    members: JSON.parse(localStorage.getItem('h_members_v19')) || {
                        girl: { name: 'è€å©† ğŸ’–', note: 'ç¾é£Ÿç‰¹æ´¾å“¡', img: 'https://api.dicebear.com/7.x/avataaars/svg?seed=Aneka' },
                        boy: { name: 'è€å…¬ ğŸ¦¨', note: 'æœ€å¼·å°èˆª', img: 'https://api.dicebear.com/7.x/avataaars/svg?seed=Felix' }
                    },
                    trips: JSON.parse(localStorage.getItem('h_trips_v19') || '[]'),
                    expenses: JSON.parse(localStorage.getItem('h_money_v19') || '[]'),
                    checklist: JSON.parse(localStorage.getItem('h_list_v19') || '[]')
                }
            },
            computed: {
                globalCountdown() {
                    const diff = new Date(this.startDate) - new Date();
                    return Math.max(0, Math.ceil(diff / (1000 * 60 * 60 * 24)));
                },
                filteredTrips() { return this.trips.filter(t => t.day === this.currentDay).sort((a,b) => a.startTime.localeCompare(b.startTime)); },
                totalSpent() { return this.expenses.reduce((sum, item) => sum + (item.amount || 0), 0); }
            },
            methods: {
                getShortDate(day) {
                    const d = new Date(this.startDate); d.setDate(d.getDate() + (day - 1));
                    return `${d.getMonth() + 1}/${d.getDate()}`;
                },
                getWeekDay(day) {
                    const d = new Date(this.startDate); d.setDate(d.getDate() + (day - 1));
                    return ['æ—¥','ä¸€','äºŒ','ä¸‰','å››','äº”','å…­'][d.getDay()];
                },
                addTrip() { if(this.newTrip.desc && this.newTrip.startTime){ this.trips.push({ id: Date.now(), day: this.currentDay, ...this.newTrip }); this.save(); this.newTrip = { startTime: '', endTime: '', desc: '', note: '' }; } },
                removeTrip(id) { this.trips = this.trips.filter(t => t.id !== id); this.save(); },
                addExp() { if(this.newExp.amount){ this.expenses.push({...this.newExp}); this.save(); this.newExp = { amount: null, note: '' }; } },
                addItem() { if(this.newItem){ this.checklist.push({ text: this.newItem, done: false }); this.save(); this.newItem = ''; } },
                toggleItem(i) { this.checklist[i].done = !this.checklist[i].done; this.save(); },
                removeItem(i) { this.checklist.splice(i, 1); this.save(); },
                saveMembers() { localStorage.setItem('h_members_v19', JSON.stringify(this.members)); localStorage.setItem('h_start_v19', this.startDate); alert('è¨­å®šå·²æ›´æ–°ï¼'); },
                save() {
                    localStorage.setItem('h_trips_v19', JSON.stringify(this.trips));
                    localStorage.setItem('h_money_v19', JSON.stringify(this.expenses));
                    localStorage.setItem('h_list_v19', JSON.stringify(this.checklist));
                }
            }
        }).mount('#app')
    </script>
</body>
</html>
