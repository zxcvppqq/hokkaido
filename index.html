<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>åŒ—æµ·é“èœœæœˆæ—…è¡Œ â„ï¸ é¦¬ä¾†è²˜æ‰‹å¸³</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <style>
        :root { 
            --bg: #F2F2F2; 
            --malaimo-black: #333333; 
            --malaimo-white: #FFFFFF; 
            --romantic-pink: #FFB7C5; 
            --snow-blue: #E0F2F7;
        }
        
        body { 
            background: var(--bg); 
            background-image: radial-gradient(#ffffff 1px, transparent 1px);
            background-size: 20px 20px;
            font-family: -apple-system, "Microsoft JhengHei", sans-serif; 
            margin: 0; padding: 20px 15px 120px 15px; color: var(--malaimo-black); 
        }

        /* é ‚éƒ¨æ¨™é¡Œ */
        .header { display: flex; justify-content: space-between; align-items: flex-end; margin-bottom: 25px; }
        .title-group h1 { margin: 0; font-size: 24px; letter-spacing: 1px; }
        .avatars { display: flex; }
        .avatar-box { width: 40px; height: 40px; border-radius: 50%; border: 2px solid white; overflow: hidden; box-shadow: 0 4px 8px rgba(0,0,0,0.1); margin-left: -12px; }

        /* å¤©æ•¸åˆ‡æ› */
        .day-selector { display: flex; overflow-x: auto; gap: 10px; padding: 10px 0; margin-bottom: 20px; -webkit-overflow-scrolling: touch; }
        .day-btn { 
            flex: 0 0 auto; padding: 10px 18px; border-radius: 15px; 
            background: var(--malaimo-white); border: 1.5px solid var(--malaimo-black);
            font-weight: bold; font-size: 13px; transition: 0.2s;
        }
        .day-btn.active { background: var(--malaimo-black); color: white; transform: scale(1.05); }

        /* å¡ç‰‡è¨­è¨ˆ */
        .card { 
            background: var(--malaimo-white); border-radius: 22px; padding: 18px; 
            margin-bottom: 18px; box-shadow: 0 6px 0px #DDD; 
            border: 2px solid var(--malaimo-black); position: relative;
        }

        /* è¡¨å–®æ¨£å¼ */
        .input-group { margin-bottom: 10px; }
        input { 
            width: 100%; padding: 12px; margin-top: 5px; border: 1.5px solid #EEE; 
            border-radius: 10px; font-size: 15px; box-sizing: border-box;
        }
        .btn { 
            background: var(--malaimo-black); color: white; border: none; 
            padding: 14px; border-radius: 12px; width: 100%; font-weight: bold; 
            font-size: 16px; margin-top: 10px; cursor: pointer;
        }

        /* è¡Œç¨‹é …ç›® */
        .trip-time { color: var(--romantic-pink); font-weight: bold; font-size: 14px; margin-bottom: 5px; display: block; }
        .trip-desc { font-size: 18px; font-weight: bold; display: block; margin-bottom: 8px; }
        .info-tag { font-size: 12px; color: #777; display: flex; align-items: center; margin-bottom: 5px; }
        .info-tag i { margin-right: 5px; font-style: normal; }

        .map-btn { 
            display: inline-block; margin-top: 10px; padding: 8px 16px; 
            background: var(--snow-blue); color: #444; border-radius: 8px; 
            text-decoration: none; font-size: 13px; font-weight: bold; border: 1px solid #BDE0EA;
        }

        /* åº•éƒ¨å°è¦½ */
        .nav-bar { 
            position: fixed; bottom: 20px; left: 20px; right: 20px; height: 70px; 
            background: var(--malaimo-black); border-radius: 35px;
            display: flex; justify-content: space-around; align-items: center;
            box-shadow: 0 8px 25px rgba(0,0,0,0.3); z-index: 1000;
        }
        .nav-item { color: #888; text-align: center; border: none; background: none; flex: 1; }
        .nav-item.active { color: var(--romantic-pink); }
        .nav-icon { font-size: 22px; display: block; }
        .nav-text { font-size: 10px; margin-top: 3px; }

        .delete-btn { color: #DDD; font-size: 16px; float: right; cursor: pointer; }
    </style>
</head>
<body>
    <div id="app">
        <div class="header">
            <div class="title-group">
                <h1>åŒ—æµ·é“èœœæœˆæ—…è¡Œ ğŸ¦¨</h1>
                <small style="color:#888;">â„ï¸ Romantic 12 Days Trip</small>
            </div>
            <div class="avatars">
                <div class="avatar-box" style="z-index:2;"><img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Felix" width="40"></div>
                <div class="avatar-box" style="z-index:1;"><img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Aneka" width="40"></div>
            </div>
        </div>

        <div v-if="activeTab === 'trip'">
            <div class="day-selector">
                <div v-for="d in 12" :key="d" :class="['day-btn', {active: currentDay === d}]" @click="currentDay = d">
                    Day {{ d }}
                </div>
            </div>

            <div class="card">
                <div style="font-weight:bold; margin-bottom:10px;">âœï¸ è¦åŠƒ Day {{ currentDay }}</div>
                <input v-model="newTrip.time" type="time" placeholder="æ™‚é–“">
                <input v-model="newTrip.desc" placeholder="æ™¯é»æˆ–é¤å»³åç¨±">
                <input v-model="newTrip.openTime" placeholder="ç‡Ÿæ¥­æ™‚é–“ (å¦‚ï¼š09:00-18:00)">
                <input v-model="newTrip.mapUrl" placeholder="Google Map é€£çµ">
                <button class="btn" @click="addTrip">åŠ å…¥æµªæ¼«æ‰‹å¸³</button>
            </div>

            <div v-if="filteredTrips.length > 0">
                <div v-for="(item, index) in filteredTrips" :key="index" class="card">
                    <span class="delete-btn" @click="removeTrip(item.id)">âœ•</span>
                    <span class="trip-time">âŒš {{ item.time || 'å…¨å¤©' }}</span>
                    <span class="trip-desc">{{ item.desc }}</span>
                    
                    <div v-if="item.openTime" class="info-tag">
                        <i>ğŸ•’</i> ç‡Ÿæ¥­æ™‚é–“ï¼š{{ item.openTime }}
                    </div>

                    <a v-if="item.mapUrl" :href="item.mapUrl" target="_blank" class="map-btn">ğŸ“ åœ°åœ–å°èˆª</a>
                </div>
            </div>
            <div v-else style="text-align:center; padding:50px; color:#CCC;">
                ğŸ¦¨ğŸ’¨<br>é€™å¤©é‚„æ²’æœ‰è¡Œç¨‹å–”
            </div>
        </div>

        <div v-if="activeTab === 'money'">
            <div class="card" style="background: var(--malaimo-black); color: white; text-align: center; border:none;">
                <div style="font-size: 13px; opacity: 0.8;">ç”œèœœç¸½æ”¯å‡º (æ—¥å¹£)</div>
                <div style="font-size: 34px; font-weight: bold; margin: 8px 0;">Â¥ {{ totalSpent }}</div>
                <div style="background:var(--romantic-pink); display:inline-block; padding:3px 12px; border-radius:15px; font-size:12px;">
                    ç´„ NT$ {{ Math.round(totalSpent * 0.21) }}
                </div>
            </div>

            <div class="card">
                <input v-model.number="newExp.amount" type="number" placeholder="è¼¸å…¥æ—¥å¹£é‡‘é¡">
                <input v-model="newExp.note" placeholder="æ”¯å‡ºé …ç›®åç¨±">
                <button class="btn" @click="addExp">å„²å­˜æ”¯å‡º</button>
            </div>

            <div v-for="(exp, index) in expenses" :key="index" class="card" style="padding: 15px; box-shadow: 0 4px 0px #DDD;">
                <div style="display:flex; justify-content:space-between; align-items:center;">
                    <span>ğŸ–¤ {{ exp.note }}</span>
                    <b style="font-size: 17px;">Â¥ {{ exp.amount }}</b>
                    <span class="delete-btn" @click="removeExp(index)">âœ•</span>
                </div>
            </div>
        </div>

        <div v-if="activeTab === 'member'">
            <div class="card">
                <div style="display:flex; align-items:center;">
                    <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Felix" width="55" style="border-radius:50%; border:2px solid #333;">
                    <div style="margin-left:15px;">
                        <b style="font-size:18px;">ç”·ä¸»è§’ ğŸ¦¨</b><br>
                        <small style="color:#888;">è² è²¬å°èˆªã€æ‹ç…§èˆ‡æé‡ç‰©</small>
                    </div>
                </div>
            </div>
            <div class="card">
                <div style="display:flex; align-items:center;">
                    <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Aneka" width="55" style="border-radius:50%; border:2px solid #333;">
                    <div style="margin-left:15px;">
                        <b style="font-size:18px;">å¥³ä¸»è§’ ğŸ’–</b><br>
                        <small style="color:#888;">è² è²¬å°‹æ‰¾ç¾é£Ÿèˆ‡äº«å—é›ªæ™¯</small>
                    </div>
                </div>
            </div>
        </div>

        <nav class="nav-bar">
            <button class="nav-item" :class="{active: activeTab === 'trip'}" @click="activeTab = 'trip'">
                <span class="nav-icon">ğŸ—“ï¸</span><span class="nav-text">è¡Œç¨‹</span>
            </button>
            <button class="nav-item" :class="{active: activeTab === 'money'}" @click="activeTab = 'money'">
                <span class="nav-icon">ğŸª™</span><span class="nav-text">é–‹éŠ·</span>
            </button>
            <button class="nav-item" :class="{active: activeTab === 'member'}" @click="activeTab = 'member'">
                <span class="nav-icon">ğŸ‘¥</span><span class="nav-text">æˆ‘å€‘</span>
            </button>
        </nav>
    </div>

    <script>
        const { createApp } = Vue
        createApp({
            data() {
                return {
                    activeTab: 'trip', currentDay: 1,
                    newTrip: { time: '', desc: '', mapUrl: '', openTime: '' },
                    newExp: { amount: null, note: '' },
                    // ä½¿ç”¨æ–°çš„ç‰ˆæœ¬è™Ÿé˜²æ­¢èˆŠè³‡æ–™å¹²æ“¾
                    trips: JSON.parse(localStorage.getItem('h_trips_v5') || '[]'),
                    expenses: JSON.parse(localStorage.getItem('h_money_v5') || '[]')
                }
            },
            computed: {
                filteredTrips() {
                    return this.trips.filter(t => t.day === this.currentDay).sort((a,b) => a.time.localeCompare(b.time));
                },
                totalSpent() {
                    return this.expenses.reduce((sum, item) => sum + (item.amount || 0), 0);
                }
            },
            methods: {
                addTrip() {
                    if(this.newTrip.desc){
                        this.trips.push({ id: Date.now(), day: this.currentDay, ...this.newTrip });
                        this.save();
                        this.newTrip = { time: '', desc: '', mapUrl: '', openTime: '' };
                    }
                },
                removeTrip(id) { this.trips = this.trips.filter(t => t.id !== id); this.save(); },
                addExp() {
                    if(this.newExp.amount){
                        this.expenses.push({...this.newExp});
                        this.save();
                        this.newExp = { amount: null, note: '' };
                    }
                },
                removeExp(i) { this.expenses.splice(i, 1); this.save(); },
                save() {
                    localStorage.setItem('h_trips_v5', JSON.stringify(this.trips));
                    localStorage.setItem('h_money_v5', JSON.stringify(this.expenses));
                }
            }
        }).mount('#app')
    </script>
</body>
</html>
