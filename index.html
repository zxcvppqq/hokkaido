<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>åŒ—æµ·é“æ‰‹å¸³ğŸ¾</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <style>
        :root { --tea: #D4A373; --bg: #FDF8F3; }
        body { background: var(--bg); font-family: sans-serif; margin: 0; padding-bottom: 100px; color: #5D4037; }
        
        /* é£„é›ªèƒŒæ™¯ */
        .snow { position: fixed; top: 0; color: #fff; pointer-events: none; z-index: 99; animation: v 5s linear infinite; }
        @keyframes v { from { transform: translateY(-10vh); } to { transform: translateY(110vh); } }

        /* é ‚éƒ¨ */
        .header { background: #fff; padding: 40px 20px 20px; text-align: center; border-bottom-left-radius: 40px; border-bottom-right-radius: 40px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); }
        
        /* å¡ç‰‡ */
        .card { background: #fff; border-radius: 25px; padding: 15px; margin: 12px; border: 1px solid #E6D5B8; position: relative; box-shadow: 0 4px 10px rgba(0,0,0,0.02); }
        .note { background: #FFFBF0; padding: 10px; border-radius: 15px; margin-top: 10px; border: 1px dashed #D4A373; font-size: 14px; }
        
        /* å°è¦½åˆ—ï¼šé»‘ç³–çç é¦¬ä¾†è²˜é¢¨ */
        .nav-box { position: fixed; bottom: 25px; left: 15px; right: 15px; z-index: 1000; }
        .nav { background: #1a1a1a; height: 70px; border-radius: 35px; display: flex; justify-content: space-around; align-items: center; box-shadow: 0 10px 30px rgba(0,0,0,0.3); }
        .n-btn { color: #888; border: none; background: none; text-align: center; font-size: 10px; }
        .n-btn.active { color: #fff; font-weight: bold; }
        .n-btn span { font-size: 20px; display: block; }

        /* è¼¸å…¥æ¡†èˆ‡æŒ‰éˆ• */
        input, textarea, select { width: 100%; padding: 12px; margin-top: 8px; border: 1px solid #eee; border-radius: 15px; box-sizing: border-box; }
        .btn { background: var(--tea); color: #fff; border: none; padding: 15px; border-radius: 20px; width: 100%; font-weight: bold; margin-top: 10px; }
        
        /* æ—¥æœŸé¸æ“‡ */
        .dates { display: flex; overflow-x: auto; padding: 10px; gap: 10px; }
        .d-item { flex: 0 0 60px; height: 70px; background: #fff; border: 1px solid #E6D5B8; border-radius: 20px; text-align: center; display: flex; flex-direction: column; justify-content: center; }
        .d-item.active { background: var(--tea); color: #fff; }
    </style>
</head>
<body>
    <div id="app">
        <div v-for="n in 10" :key="n" class="snow" :style="{left: n*10+'vw', animationDelay: n*0.5+'s'}">â„</div>

        <div class="header">
            <div style="font-weight: 900; font-size: 22px;">åŒ—æµ·é“ â„ï¸ èœœæœˆæ‰‹å¸³</div>
            <div style="background:#000; color:#fff; display:inline-block; padding:2px 12px; border-radius:20px; font-size:12px; margin-top:8px;">ğŸ¾ å€’æ•¸ {{ globalCD }} å¤©</div>
        </div>

        <div v-if="tab === 'trip'">
            <div class="dates">
                <div v-for="d in 12" :key="d" class="d-item" :class="{active: day === d}" @click="day = d">
                    <small>D{{d}}</small><b>{{ getD(d) }}</b>
                </div>
            </div>
            <div class="card">
                <input v-model="fT.title" placeholder="æ™¯é»åç¨±">
                <textarea v-model="fT.note" placeholder="å‚™å¿˜éŒ„..."></textarea>
                <button class="btn" @click="addT">å„²å­˜è¡Œç¨‹ ğŸ¾</button>
            </div>
            <div v-for="t in filteredT" :key="t.id" class="card">
                <div @click="removeT(t.id)" style="position:absolute; right:15px; color:#ccc;">âœ•</div>
                <div style="font-weight:bold; font-size:18px;">{{ t.title }}</div>
                <div v-if="t.note" class="note">{{ t.note }}</div>
            </div>
        </div>

        <div v-if="tab === 'book'">
            <div style="display:flex; gap:10px; padding:15px;">
                <button @click="sub='t'" :style="sub==='t'?'background:#000;color:#fff':'background:#fff'" style="flex:1; padding:10px; border-radius:15px; border:1px solid #000;">âœˆï¸ äº¤é€š</button>
                <button @click="sub='s'" :style="sub==='s'?'background:#000;color:#fff':'background:#fff'" style="flex:1; padding:10px; border-radius:15px; border:1px solid #000;">ğŸ¨ ä½å®¿</button>
            </div>
            <div class="card">
                <input v-model="fB.title" :placeholder="sub==='t'?'èˆªç­è™Ÿ':'é£¯åº—å'">
                <input v-model="fB.info" placeholder="åœ°å€æˆ–è©³ç´°è³‡è¨Š">
                <button class="btn" @click="addB">å„²å­˜é è¨‚</button>
            </div>
            <div v-for="(b, i) in (sub==='t'?books.t:books.s)" :key="i" class="card">
                <div @click="removeB(i)" style="position:absolute; right:15px; color:#ccc;">âœ•</div>
                <div style="font-weight:bold;">{{ b.title }}</div>
                <div style="font-size:14px; color:#888;">{{ b.info }}</div>
            </div>
        </div>

        <div v-if="tab === 'money'">
            <div style="background:#43382F; color:#fff; border-radius:30px; padding:30px; margin:15px; text-align:center;">
                <div style="font-size:12px; opacity:0.6;">TOTAL</div>
                <div style="font-size:32px; font-weight:bold;">Â¥ {{ total }}</div>
                <div style="color:#D4A373;">NT$ {{ Math.round(total * 0.21) }}</div>
            </div>
            <div class="card">
                <input v-model.number="fM.amt" type="number" placeholder="é‡‘é¡ (JPY)">
                <input v-model="fM.note" placeholder="é …ç›®å…§å®¹">
                <button class="btn" @click="addM">ç´€éŒ„æ”¯å‡º ğŸª™</button>
            </div>
            <div v-for="(m, i) in exps" :key="i" class="card" style="display:flex; justify-content:space-between;">
                <span>{{ m.note || 'æ”¯å‡º' }}</span>
                <b>Â¥ {{ m.amt }}</b>
            </div>
        </div>

        <div class="nav-box">
            <nav class="nav">
                <button class="n-btn" :class="{active: tab==='trip'}" @click="tab='trip'"><span>ğŸ—“ï¸</span>è¡Œç¨‹</button>
                <button class="n-btn" :class="{active: tab==='book'}" @click="tab='book'"><span>ğŸ”–</span>é è¨‚</button>
                <button class="n-btn" :class="{active: tab==='money'}" @click="tab='money'"><span>ğŸª™</span>è¨˜å¸³</button>
            </nav>
        </div>
    </div>

    <script>
        const { createApp } = Vue
        createApp({
            data() {
                return {
                    tab: 'trip', day: 1, sub: 't', start: '2026-01-12',
                    fT: { title: '', note: '' }, fB: { title: '', info: '' }, fM: { amt: null, note: '' },
                    trips: JSON.parse(localStorage.getItem('my_t') || '[]'),
                    books: JSON.parse(localStorage.getItem('my_b') || '{"t":[],"s":[]}'),
                    exps: JSON.parse(localStorage.getItem('my_m') || '[]')
                }
            },
            computed: {
                globalCD() { return Math.max(0, Math.ceil((new Date(this.start) - new Date()) / 86400000)); },
                filteredT() { return this.trips.filter(t => t.day === this.day); },
                total() { return this.exps.reduce((s, e) => s + (e.amt || 0), 0); }
            },
            methods: {
                getD(d) { const dt = new Date(this.start); dt.setDate(dt.getDate() + (d-1)); return (dt.getMonth()+1)+'/'+dt.getDate(); },
                addT() { if(!this.fT.title) return; this.trips.push({ id: Date.now(), day: this.day, ...this.fT }); this.save(); this.fT = { title: '', note: '' }; },
                removeT(id) { this.trips = this.trips.filter(t => t.id !== id); this.save(); },
                addB() { if(!this.fB.title) return; this.books[this.sub].push({...this.fB}); this.save(); this.fB = { title: '', info: '' }; },
                removeB(i) { this.books[this.sub].splice(i, 1); this.save(); },
                addM() { if(this.fM.amt){ this.exps.unshift({...this.fM}); this.save(); this.fM = { amt: null, note: '' }; } },
                save() {
                    localStorage.setItem('my_t', JSON.stringify(this.trips));
                    localStorage.setItem('my_b', JSON.stringify(this.books));
                    localStorage.setItem('my_m', JSON.stringify(this.exps));
                }
            }
        }).mount('#app')
    </script>
</body>
</html>
